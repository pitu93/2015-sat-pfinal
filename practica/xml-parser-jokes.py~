#!/usr/bin/python

#
# Simple XML parser for JokesXML
# Jesus M. Gonzalez-Barahona
# jgb @ gsyc.es
# TSAI and SAT subjects (Universidad Rey Juan Carlos)
# September 2009
#
# Just prints the jokes in a JokesXML file

from xml.sax.handler import ContentHandler
from xml.sax import make_parser
import sys
import string
from xml.dom import minidom

def normalize_whitespace(text):
    "Remove redundant whitespace from a string"
    return string.join(string.split(text), ' ')

class CounterHandler(ContentHandler):

    def __init__ (self):
        self.inContent = 0
        self.theContent = ""

    def startElement (self, name, attrs):
        

        if name == 'atributos':
            self.title = normalize_whitespace(attrs.get('idioma'))
            self.inContent = 1
            print " title: " + self.title + "."
        elif name == 'atributo':
            self.inContent = 1
        elif name == 'atributo':
            self.inContent = 1
            
    def endElement (self, name):
        if self.inContent:
            self.theContent = normalize_whitespace(self.theContent)
        if name == 'atributos':
            print "atributos" + self.theContent
        elif name == 'atributo':
            print "  start: " + self.theContent + "."
        elif name == 'atributo':
            print "  end: " + self.theContent + "."
        if self.inContent:
            self.inContent = 0
            self.theContent = ""
        
    def characters (self, chars):
        if self.inContent:
            self.theContent = self.theContent + chars
            
# --- Main prog

    
# Load parser and driver

JokeParser = make_parser()
JokeHandler = CounterHandler()
JokeParser.setContentHandler(JokeHandler)

# Ready, set, go!

xmlFile = open(sys.argv[1],"r")
JokeParser.parse(xmlFile)


print "Parse complete"
